<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Untitled Document</title>
    <!-- Bootstrap -->
	<link href="css/bootstrap.css" rel="stylesheet">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
  </head>
  <body onLoad="myFunction()">
	<div class="container" style="width: 100%">
      <header class="row">
        <div class="col-lg-12">
          <h1>Admin Firebase UI</h1>
        </div>
      </header>
      <div class="row">
        <div class="col-lg-12">
          <ul class="nav nav-tabs">
            <li role="presentation"><a href="category.html">Select category</a></li>
            <li role="presentation"><a href="question.html">Find question</a></li>
          </ul>
        </div>
      </div>
      <div class="row">
    <div class="col-lg-12">
      <p>Single Question page</p>
    </div>
      </div>
	</div>
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) --> 
	<script src="js/jquery-1.11.3.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>  
<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase-database.js"></script>
 <script src="https://www.gstatic.com/firebasejs/4.1.3/firebase-storage.js"></script>

	<!-- Include all compiled plugins (below), or include individual files as needed --> 
	<script src="js/bootstrap.js"></script>
	<script> 
	  function myFunction(){ 
		  var url = window.location.href;	   
		  var category=getParameter(url,"category");
		  var question=getParameter(url,"question")
		  var config = {
			  apiKey: "AIzaSyCwYIYau4w3LKZ4EuKZPdBIfbdmg1JsWvQ", 	   
			  databaseURL: "https://studymechanics.firebaseio.com"      
		  };
			function isEmpty(obj) {
			return Object.keys(obj).length === 0;
		}
			firebase.initializeApp(config);
		  var oneQuestionQuery= firebase.database().ref("questions").child(category).child("questions").child(question).orderByKey();
  oneQuestionQuery.once("value").then(
        function(snapshot) {   	  	   
        	snapshot.forEach(function(childSnapshot) {
              key=childSnapshot.key;			  
			  if(key=="answers"){
			     childSnapshot.forEach(function(answerSnapshot){
				      console.log("Creating row for"+answerSnapshot.key);
					  createAnswerRow(answerSnapshot.key,"questionContainer");
					  var answer=answerSnapshot.val();
					  console.log(answer);
					  document.getElementById("textarea"+answerSnapshot.key).innerHTML=answer["text"];
					  downloadAndDisplayImage(answer["img"],"image"+answerSnapshot.key);					 					  		    
				 });//childSnapshot.forEach end	
				 createHugeButton("questionContainer");   
			  } else{
    			  if(key=="img"){
    			   //load image				   
				   downloadAndDisplayImage(childSnapshot.val(),"questionImg");				   
				   
    			  } else{
    			  	if(key=="text")  document.getElementById("questionText").innerHTML=childSnapshot.val();
    			  }
			  }
    			
    	    });  						
         }
    );//end of oneQuestionQuery.once("value").then 
	 
	  
		  
		  
		  
		  
		  
		  	
		  
	  }//end of function myFunction()
		function getParameter(url,name){
		var pattern=  RegExp(name+'=([^&]+)', 'i')
		var captured = pattern.exec(url)[1];
    //var captured = /category=([^&]+)/.exec(url)[1]; // Value is in [1] ('384' in our case)
    var result = captured ? captured : 'notFound';
			return result;
			
		}
	  </script>
  </body>
</html>
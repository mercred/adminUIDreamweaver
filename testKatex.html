<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Untitled Document</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
<link href="css/bootstrap.css" rel="stylesheet" type="text/css">
<link href="css/custom.css" rel="stylesheet" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body onLoad="testParsing()">

<div class="container" id="mainContainer">


 
</div>

<script>
    //renderMathInElement(document.body);
</script>
<script>
	 
	
	function playWithPopo(){
	
	showPopup();
	function showPopup() {
    // show the mask
    $("#mask").fadeTo(500, 0.25);

    // show the popup
    $("#popup").show();
}
	
	$("#popup").click(function() {

        $(this).hide();
        $("#mask").hide();

    });	
		}
	function testKatex(){			
	}
	function testParsing(){
		
		var text="sometext nulla risus sit amet eros. Donec tempor dignissim nibh. Pellentesque lobortis sapien pellentesque, facilisis nisl vitae, mattis urna. Maecenas quis mi a lorem dictum tincidunt. Ut gravida, diam nec finibus tincidunt, enim neque laoreet diam, sed lacinia est erat ut turpis. Mauris ultrices eros at luctus euismod.\\( c = \\pm\\sqrt{a^2 + b^2}\\)   img232a sadf img1dfgd <a href='google.com'> Example text</a> img1";
	var textWithoutTags="eet sem quis, rutrum felis. Integer eleifend suscipit lacinia. Nulla iaculis, massa a eleifend fringilla, nunc purus scelerisque lorem, ac fermentum nulla risus sit amet eros. Donec tempor dignissim nibh. Pellentesque lobortis sapien pellentesque, facilisis nisl vitae, mattis urna. Maecenas quis mi a lorem dictum tincidunt. Ut gravida, diam nec finibus tincidunt, enim neque laoreet diam, sed lacinia est erat ut turpis. Mauris ultrices eros at luctus euismod.";
	var parentID="mainContainer";
		var res;
		var pattern =new RegExp("img\\d+.*");
		var mainString="";
	    var splitString=text.split(" ");
		for (i = 0; i < splitString.length; i++) {
			res=pattern.exec(splitString[i]);
			if(res!=null&&res!=undefined){
				//add div with current text
				if(mainString!=""&&mainString!=null){
					insertText(mainString,parentID);
					console.log("Inserting text "+ mainString);
					mainString="";
				}
				//insert image
				console.log("Inserting image "+splitString[i]);
				//get URL from name
				insertImage(splitString[i],parentID );
				}else{
					mainString+=" "+splitString[i];
				}
			
			
		}
		if(mainString!=""&&mainString!=null){
				console.log("Inserting text "+ mainString);
					insertText(mainString,parentID);
		}
		renderMathInElement(document.body);				
	}
	
	
	
	function insertText(text,parentElementID){
		var rowDiv = document.createElement("div");
		rowDiv.className="row";
		var colDiv=document.createElement("div");
		colDiv.className="col-lg-12";
		colDiv.innerHTML=text;		
		rowDiv.appendChild(colDiv);	
		document.getElementById(parentElementID).appendChild(rowDiv);		
	}
	
	function insertImage(imageURL,parentElementID){
		var rowDiv = document.createElement("div");
		rowDiv.className="row";
		var colDiv=document.createElement("div");
		rowDiv.className="col-lg-12";
		
		var image = document.createElement("img");
		image.src=imageURL;
		image.className="img-responsive";
		image.alt="Placeholder image";		
		
		colDiv.appendChild(image);	
		rowDiv.appendChild(colDiv);	
		document.getElementById(parentElementID).appendChild(rowDiv);		
	}	
	
	
	
</script>
<script src="js/libraries/jquery-1.11.3.min.js"></script>
</body>
</html>
